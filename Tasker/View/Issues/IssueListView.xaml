<UserControl x:Class="Tasker.View.IssueListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:MyControls="clr-namespace:Tasker.Controls"
             xmlns:wpf="clr-namespace:PixelLab.Wpf;assembly=PixelLab.Wpf" xmlns:Helpers="clr-namespace:Tasker.Helpers"
             xmlns:localView="clr-namespace:Tasker.View"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                xmlns:mui="http://firstfloorsoftware.com/ModernUI"
             xmlns:classes="clr-namespace:Tasker.Classes" d:DesignWidth="350"
             DataContext="{Binding IssueListViewModel,
                                   Source={StaticResource Locator}}"
             mc:Ignorable="d">

    <UserControl.Resources>

    </UserControl.Resources>
    <Grid >
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="30*" />
        </Grid.RowDefinitions>

        <Border x:Name="RevealContainer"
                Grid.Row="0"
                Margin="0,0,0,0"
                >
           <wpf:Reveal x:Name="TaskDetailsReveal"
                        Duration="150"
                       
                          IsExpanded="{Binding ShowEditTask}" >
 
                     <localView:TaskView x:Name="oTaskView" />
            </wpf:Reveal>
        </Border>
        <!--IsManipulationEnabled="{Binding IsEditTaskHidden}"-->
        <classes:FilterControl  Margin="5" Height="25" Header="Search item here" 
                            TargetControl="{Binding ElementName=LstItems}" 
                            FilterTextBindingPath="Title">
            <classes:FilterControl.ListTextBindingPath>
                <classes:FilterAdapter Title="Issue Id" PropertyBound="IssueId"/>
                <classes:FilterAdapter Title="Summary" PropertyBound="Title"/>
                <classes:FilterAdapter Title="Asigned" PropertyBound="UserName"/>
                <classes:FilterAdapter Title="Issue Type" PropertyBound="IssueType"/>
                <classes:FilterAdapter Title="Status" PropertyBound="Status"/>
            </classes:FilterControl.ListTextBindingPath>
        </classes:FilterControl>
        
        <ListBox Grid.Row="1"
                 Background="#4F4F4D4D"
                 BorderBrush="Transparent"
                 x:Name="LstItems"
                 Helpers:ControlItemDoubleClick.ItemsDoubleClick="true"
         
                 ItemContainerStyle="{StaticResource RedGlowItemContainer1}"
                 ItemsSource="{Binding IssueItemList}"
                 SelectedItem="{Binding SelectedIssueItem}">
             
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="MouseDoubleClick">
                    <i:InvokeCommandAction Command="{Binding NewSubTaskCommand}"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
            <ListBox.ItemTemplate>
                <DataTemplate>

                    <Grid Background="#20A9A9A9" MinHeight="40" MaxHeight="120" Width="320" x:Name="ItemGrid" >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30" />
                            <ColumnDefinition Width="200" />
                            <ColumnDefinition Width="90*" />
                        </Grid.ColumnDefinitions>


                        <Path x:Name="PathIssue"
                                Data= "M24.848307,59.99683C25.564407,59.986874 26.180643,60.516605 26.266891,61.244083 26.340893,62.006058 25.794889,62.698036 25.022884,62.792034L14.458817,63.993999C14.402818,64 14.354817,64 14.301817,64 13.595812,64 12.993809,63.474014 12.909808,62.756035 12.820807,61.994061 13.374811,61.301079 14.141816,61.213081L24.703882,60.006119C24.752382,60.000557,24.800566,59.997494,24.848307,59.99683z M28.284885,54.834461C28.99403,54.827339 29.607101,55.366383 29.684914,56.088238 29.766914,56.855213 29.215912,57.551193 28.445906,57.630192L11.027796,59.568134C10.977796,59.568134 10.924795,59.574131 10.871795,59.574131 10.16779,59.574131 9.5597868,59.042149 9.4827862,58.324169 9.3967857,57.562195 9.9537888,56.870213 10.720794,56.787216L28.141905,54.843277C28.189905,54.837841,28.237608,54.834938,28.284885,54.834461z M28.284885,50.098011C28.99403,50.097446 29.607101,50.635967 29.684914,51.34938 29.766914,52.120358 29.215912,52.818336 28.445906,52.894333L11.027796,54.838276C10.977796,54.843277 10.924795,54.843277 10.871795,54.843277 10.16979,54.843277 9.5597868,54.31229 9.4827862,53.593311 9.3967857,52.824337 9.9537888,52.130356 10.720794,52.051361L28.141905,50.105419C28.189905,50.100483,28.237608,50.098049,28.284885,50.098011z M18.903522,4.9370003C11.562632,4.9370003 5.625,10.874637 5.625,18.212755 5.625,19.062279 6.3165197,19.75 7.1681271,19.75 8.0169945,19.75 8.7110147,19.062279 8.7110147,18.212755 8.7110147,15.394371 9.8412476,12.849395 11.69013,10.999741 13.543003,9.1505651 16.079466,8.0191212 18.903522,8.0191212 19.753811,8.0191212 20.440001,7.323791 20.440001,6.4741554 20.440001,5.6245203 19.74991,4.9370003 18.903522,4.9370003z M19.5858,0C30.396999,0 39.167999,8.7303715 39.167999,19.480316 39.167999,26.593584 32.614601,33.212654 32.614601,33.212654 30.9778,34.855347 29.6341,38.119537 29.6341,40.448326L29.6341,41.051121C29.6341,43.379913,27.730301,45.292,25.396999,45.292L13.7734,45.292C11.4401,45.292,9.5338097,43.379913,9.5338097,41.051121L9.5338097,40.448326C9.5338097,38.119537 8.1900597,34.855347 6.5573702,33.212654 6.5573702,33.212654 3.8724238E-08,26.593584 0,19.480316 3.8724238E-08,8.7303715 8.7669096,0 19.5858,0z"
                                Stretch="Uniform" Width="20" Height="20" Margin="5,0,5,0" RenderTransformOrigin="0.5,0.5" Fill="#FFE3C800" ToolTip="{Binding IssueType}">
                        </Path>

                        <StackPanel Grid.Column="2" Margin="8,2,0,0">

                            <TextBlock FontSize="10"
                                     Foreground="{DynamicResource ItemText}"
                                     Text="{Binding UserName}"
                                    />

                             <mui:BBCodeBlock BBCode="{Binding IssueLink}" />

                            <TextBlock 
                                FontWeight="Bold"
                                     Foreground="{DynamicResource ItemText}"
                                     Text="{Binding Status}"
                                    />
                          
                            <TextBlock 
                                     Foreground="{DynamicResource ItemText}"
                                     Text="{Binding StringDate}"
                                     />

                            

                        </StackPanel>


                        <StackPanel Grid.Column="1">

                            <TextBlock 
                                   Width="200"
                                   MinWidth="20"
                                   Margin="0"
                                   VerticalAlignment="Top"
                                   Foreground= "{DynamicResource ItemText}"
                                   Text="{Binding Title}"
                                   TextWrapping="Wrap"
                                   />

                        </StackPanel>
                        

                        <Grid Grid.Column="1" Grid.Row="2">
                            
                           
                            <!--<Canvas Width="72" Height="40"> 
                                <StackPanel x:Name="PanelButtons" Visibility="Hidden" Width="72" Height="40" Orientation="Horizontal" Background="#20CC262B" HorizontalAlignment="Right" Canvas.Right="0" >
                                    <classes:AppBarButton Name="btnEditar" ToolTip="Revisar carrera"   Margin="3" VerticalAlignment="Center" Width="30" Height="30"
                                                     MetroImageSource="{StaticResource appbar_view}" />

                                    <classes:AppBarButton Name="btnActivar" ToolTip="Reponer Examen" Margin="3"  VerticalAlignment="Center"  Width="30" Height="30"
                                                     MetroImageSource="{StaticResource appbar_unlock}" />
                                </StackPanel>
                            </Canvas>-->

                            

                        </Grid>
                    </Grid>
                    <DataTemplate.Triggers>
                     <DataTrigger Binding="{Binding Path=IssueType}" Value="Bug">
                            <Setter TargetName="PathIssue" Property="Data" Value="M15.325943,51.416828C13.899435,51.416828 12.743128,52.573135 12.743128,53.998943 12.743128,55.424648 13.899435,56.580956 15.325943,56.580956 16.750952,56.580956 17.907259,55.424648 17.907259,53.998943 17.907259,52.573135 16.750952,51.416828 15.325943,51.416828z M28.879927,51.196934C27.081118,51.196934 25.624105,52.655136 25.624105,54.452045 25.624105,56.250256 27.081118,57.70726 28.879927,57.70726 30.677538,57.70726 32.134644,56.250256 32.134644,54.452045 32.134644,52.655136 30.677538,51.196934 28.879927,51.196934z M9.4319572,40.649982C7.2776442,40.649982 5.5321536,42.396091 5.5321531,44.551003 5.5321536,46.70591 7.2776442,48.450817 9.4319572,48.450817 11.585622,48.450817 13.333032,46.70591 13.333032,44.551003 13.333032,42.396091 11.585622,40.649982 9.4319572,40.649982z M21.254278,35.70586C19.433969,35.70586 17.958761,37.182468 17.958761,39.002777 17.958761,40.823082 19.433969,42.298386 21.254278,42.298386 23.073292,42.298386 24.5494,40.823082 24.5494,39.002777 24.5494,37.182468 23.073292,35.70586 21.254278,35.70586z M43.874146,31.653999C44.143753,31.653999 44.403461,31.698198 44.663967,31.729496 45.387791,34.233181 45.813,36.885464 45.813,39.661434 45.813,41.365658 45.662598,43.029682 45.383289,44.640308 45.03698,44.722404 44.68737,44.796604 44.322159,44.8214 44.168453,44.831699 44.016651,44.837002 43.866348,44.837002 42.200199,44.837002 40.672855,44.197628 39.504223,43.154678 40.638256,42.158623 41.363075,40.714687 41.363075,39.08456 41.363075,37.050854 40.235344,35.304832 38.583,34.368675 39.692329,32.857044 41.407276,31.807693 43.417835,31.6695 43.570137,31.6591 43.723141,31.653999 43.874146,31.653999z M43.734451,30.334829C43.599678,30.337198 43.464264,30.343002 43.3283,30.352318 38.980732,30.651722 35.685757,34.435764 35.985256,38.78611 36.283352,43.13776 40.063324,46.435894 44.412292,46.136391 48.761162,45.838188 52.061337,42.052948 51.763039,37.704098 51.474255,33.488342 47.912373,30.261377 43.734451,30.334829z M9.4319572,29.664034C8.005558,29.664034 6.8499117,30.820436 6.8499117,32.246346 6.8499117,33.672054 8.005558,34.828255 9.4319572,34.828255 10.858315,34.828255 12.013423,33.672054 12.013423,32.246346 12.013423,30.820436 10.858315,29.664034 9.4319572,29.664034z M43.684029,27.369762C49.438892,27.266712 54.320877,31.694532 54.719517,37.500896 54.891914,40.026924 54.182419,42.404552 52.860828,44.349873L61.354767,52.710667C62.390659,53.732777 62.403061,55.400795 61.383469,56.438606 60.361374,57.476418 58.692688,57.488117 57.653694,56.467205L48.921261,47.872112C47.627171,48.55442 46.173279,48.989323 44.61409,49.096024 38.625237,49.506229 33.434475,44.982681 33.022976,38.989212 32.61158,32.996845 37.135647,27.80549 43.1245,27.393986 43.311836,27.381126 43.498386,27.373087 43.684029,27.369762z M23.573805,24.528C27.418242,24.527794,31.562117,25.19795,35.827995,26.949202L36.184589,27.101805 36.077061,27.173956C32.341061,29.813818 30.026154,34.283436 30.361961,39.171959 30.8174,45.805222 36.056934,51.090424 42.54668,51.725159L43.116001,51.76688 43.070911,51.865242C41.494125,55.181396 39.21875,58.280025 36.344273,60.539371 34.613159,61.900078 32.575249,63.780285 30.256336,63.937786 28.160423,64.082291 26.738113,62.510681 25.538307,61.019775 24.781101,60.078369 23.987297,58.998966 23.124792,58.185162 21.025179,60.489872 20.017372,64.696991 16.013447,63.901287 13.878633,63.476887 11.463221,62.06538 9.7985401,60.703373 3.7098825,55.721546 0.32899755,47.409012 0.32899666,39.661678 0.32899755,36.782764 0.76723224,34.023754 1.5381098,31.440342L1.6981497,31.65114C2.2690127,31.221825,11.426676,24.528648,23.573805,24.528z M2.5824776,0C3.7413468,1.5579633E-07,4.7218924,0.76324481,5.0488548,1.8148766L5.0556431,1.8412857 5.2873774,1.8466721C14.188148,2.2398055,17.308636,12.447892,17.864231,14.583452L17.876692,14.632071 18.283417,14.524911C19.826834,14.150254 21.428658,13.953 23.07156,13.953 23.897484,13.953 24.712975,14.002875 25.515844,14.100098L25.838022,14.145651 25.885139,13.983273C26.756998,11.024989,29.975828,2.4183652,38.002911,1.8631744L38.340237,1.8455219 38.348114,1.8148756C38.67511,0.76324505 39.655781,4.5474735E-13 40.815048,0 42.241642,4.5474735E-13 43.397999,1.1561582 43.397999,2.5831652 43.397999,4.0088415 42.241642,5.165 40.815048,5.165 39.655781,5.165 38.67511,4.4017549 38.348114,3.3508377L38.300785,3.1668549 38.262115,3.168211C30.956564,3.5533161,28.023272,11.319921,27.184536,14.199625L27.137312,14.364344 27.884388,14.531278C33.344715,15.864889,38.070515,19.42086,41.296909,24.316515L41.661255,24.885365 41.566757,24.899141C40.891293,25.015192,40.234077,25.180925,39.598694,25.392227L39.151077,25.553562 38.496788,25.238995C23.154083,18.088844 8.7958899,24.418901 2.9189739,27.773798 5.6479292,21.872849 10.338326,17.314669 16.014261,15.217465L16.614552,15.00861 16.614033,15.00642C16.201258,13.292632,13.485216,3.5235331,5.2236691,3.1635628L5.0977592,3.1607018 5.0488548,3.3508387C4.7218924,4.4017544 3.7413468,5.164999 2.5824776,5.164999 1.1561776,5.164999 4.1722885E-07,4.0088425 0,2.5831642 4.1722885E-07,1.1561586 1.1561776,1.5579633E-07 2.5824776,0z" />
                            <Setter TargetName="PathIssue" Property="ToolTip" Value="Bug" />
                            <Setter TargetName="PathIssue" Property="Fill" Value="Red" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding Path=IssueType}" Value="Sub-task">
                            <Setter TargetName="PathIssue" Property="Data" Value="M-150.204,626.126C-152.317,626.126 -154.429,626.126 -156.541,626.126 -167.642,633.42 -180.629,646.047 -189.668,657.238 -190.916,658.782 -192.945,662.362 -193.701,662.422 -194.041,662.448 -198.024,659.719 -198.614,659.297 -202.818,656.279 -205.779,653.709 -209.257,650.899 -211.248,652.172 -212.879,653.805 -214.153,655.797 -206.627,665.074 -200.283,675.534 -193.124,685.18 -181.491,665.11 -168.473,644.683 -152.796,629.006 -151.735,627.946 -149.817,626.933 -150.204,626.126z" />
                            <Setter TargetName="PathIssue" Property="ToolTip" Value="Sub-Task" />
                            <Setter TargetName="ItemGrid" Property="Margin" Value="6,0,0,0" />
                            <Setter TargetName="ItemGrid" Property="Width" Value="314" />
                            <Setter TargetName="PathIssue" Property="Fill" Value="{DynamicResource ItemText}"/>
                        </DataTrigger>
                        
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type DataGridRow}}, Path=IsSelected}" Value="True">
                            <Setter TargetName="PathIssue" Property="Fill" Value="WhiteSmoke" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</UserControl>
